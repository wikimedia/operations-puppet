filter {
  if [type] == "sal" {
    if [channel] == "#wikimedia-labs" {
      grok {
        match => [ "message", "^!log %{NOTSPACE:project} %{GREEDYDATA:message}$" ]
        named_captures_only => true
      }
    }

    if [channel] == "#wikimedia-releng" {
      grok {
        match => [ "message", "^!log %{GREEDYDATA:message}$" ]
        named_captures_only => true
        add_field => [ "project", "releng" ]
      }
    }

    if [channel] == "#wikimedia-operations" {
      grok {
        match => [ "message", "^!log %{GREEDYDATA:message}$" ]
        named_captures_only => true
        add_field => [ "project", "production" ]
      }
    }
  } # end [type] == "sal"
}

#!/bin/bash

db=$1
. /usr/local/lib/mw-deployment-vars.sh

MWMULTIDIR=$MW_COMMON/multiversion

useDB=$db # This is the DB which the user wants to use/ query
if [ -z $db ]; then
	db=enwiki
	useDB=enwiki
elif [ "$db" == centralauth ]; then
	# We need to use fawiki here as centralauth can't be connected to using the below method.
	# As it's on the same server as fawiki, we can just use that.
	db=fawiki
fi

host=`echo 'echo wfGetLB()->getServerName(0);' | /usr/local/bin/mwscript eval.php --wiki="$db"`

MU=wikiadmin
MP=`wikiadmin_pass`

shift
mysql -u $MU -p$MP -h $host -D $useDB "$@"

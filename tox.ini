[tox]
minversion = 1.6
skipsdist = True

envlist = py27, pep8

[flake8]
max-line-length = 100
ignore =
    # E123: closing bracket does not match indentation of opening bracket’s line
    E123,
    # E133: closing bracket is missing indentation
    E133,
    # E226: missing whitespace around arithmetic operator
    E226,
    # E241: multiple spaces after ‘,’
    E241,
    # E242: tab after ‘,’
    E242,
    # E402: module level import not at top of file
    E402,
    # W503: ignore operators after line break until pep8 is upgraded
    W503
exclude =
    # Do not lint the tox runtime directory
    .tox,
    # Ignore user dotfiles and scripts
    modules/admin/files/home,
    # Upstream files that don't pass flake8 but should not be locally modified
    modules/jupyterhub/files/jupyterhub_config.py,
    modules/jupyterhub/files/nchp_config.py,
    modules/letsencrypt/files/acme_tiny.py,
    modules/mailman/files/mm_cfg.py,
    modules/postgresql/files/check_postgres_replication_lag.py,
    modules/varnish/files/varnishapi.py

[testenv]
deps =
    nose
    -rmodules/admin/data/requirements.txt
commands = nosetests modules/admin/data modules/mediawiki/files/apache/sites/redirects

[testenv:pep8]
deps = flake8==3.3.0
commands = flake8

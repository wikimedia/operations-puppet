# Override for two tasks:
# - https://phabricator.wikimedia.org/T356412
# - https://phabricator.wikimedia.org/T344324
# To test how Tegola reacts with CFSSL PKI TLS certs
# in Thanos Swift, we upgrade a single node first
# and monitor the tegola's behavior. In case of
# issues, please depool and revert.
profile::tlsproxy::envoy::ssl_provider: cfssl
profile::tlsproxy::envoy::cfssl_options:
  hosts:
    - thanos-swift.discovery.wmnet
    - thanos-swift.svc.%{::site}.wmnet
profile::tlsproxy::envoy::services:
  - server_names: ['*']
    port: 8888
profile::tlsproxy::envoy::global_cert_name: 'thanos-swift.discovery.wmnet'

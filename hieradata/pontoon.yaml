## Minimal defaults to get catalogs to compile
profile::base::labs::unattended_wmf: 'present'
profile::base::labs::unattended_distro: 'present'
profile::base::labs::unattended_osbpo: 'present'
profile::openstack::eqiad1::version: 'caracal'
profile::base::labs::clean_kernels: false
profile::base::additional_purged_packages: []

# Pontoon is including 'role' classes directly in Cloud VPS
profile::base::production::enable: false
profile::base::production::enable_ip6_mapped: false

profile::resolving::nameservers:
  - 172.20.255.1

profile::mail::default_mail_relay::smarthosts:
- 'mx-out-a.wmcloud.org'
- 'mx-out-b.wmcloud.org'
profile::mail::default_mail_relay::mediawiki_smarthosts:
- 'mx-out-a.wmcloud.org'
- 'mx-out-b.wmcloud.org'

# Default to blackholing all emails generated by Pontoon hosts
# See also https://phabricator.wikimedia.org/T296373 for more context
profile::mail::default_mail_relay::template: 'profile/mail/default_mail_relay/exim4.minimal.blackhole.erb'

profile::systemd::timesyncd::ntp_servers:
  - 'ntp-03.cloudinfra.eqiad1.wikimedia.cloud'
  - 'ntp-04.cloudinfra.eqiad1.wikimedia.cloud'

ntp_peers:
    eqiad:
    - 'ntp-03.cloudinfra.eqiad1.wikimedia.cloud'
    - 'ntp-04.cloudinfra.eqiad1.wikimedia.cloud'
    codfw: []
    ulsfo: []
    eqsin: []
    esams: []
    drmrs: []

## Disable remote syslog logging, as it breaks rsyslog in cloud VPSes.
profile::syslog::remote::enable: false
profile::syslog::remote::central_hosts_tls: {}

# Disable email alerts
profile::cumin::master::email_alerts: false
profile::cumin::master::insetup_role_report_day: 0  # disabled

## Customizations

profile::apt::use_proxy: false

## SSH access
bastion_hosts:
  - 172.16.0.0/12
## hosts using "CACHES" in firewall config
cache_hosts:
  - 172.16.0.0/12

profile::ssh::server::lookup_keys_from_ldap: true

## Cloud VPS cumin access - T287269
## If you run cumin in your stack, make sure to override this variable and _append_ your host(s)
cumin_masters:
  - 172.16.4.160 # cloud-cumin-03.cloudinfra.eqiad1.wikimedia.cloud
  - 172.16.2.249 # cloud-cumin-04.cloudinfra.eqiad1.wikimedia.cloud

## Puppet CA management
puppetmaster: "%{alias('__master_for_role_puppetserver__pontoon')}"
puppet_ca_server: "%{alias('__master_for_role_puppetserver__pontoon')}"
profile::puppet::agent::puppetmaster: "%{alias('__master_for_role_puppetserver__pontoon')}"

# profile::apt hardcodes http proxy that only works in production.  We don't need this in cloud.
profile::apt::use_proxy: false

  #profile::base::certificates::trusted_certs: ~

# don't configure benthos instances from prod hieradata
#profile::benthos::instances: {}

# default to not require etcd for easier bootstraps
profile::firewall::defs_from_etcd: false
profile::firewall::defs_from_etcd_nft: false
profile::pki::multirootca::cfssl_httpd_cert: false

profile::puppet::agent::use_srv_records: false

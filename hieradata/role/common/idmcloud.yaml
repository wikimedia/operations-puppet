profile::contacts::role_contacts: ['WMCS']
profile::base::production::role_description: 'Wikimedia identity management portal (labtest)'
profile::idm::processes: 2

profile::puppet::agent::force_puppet7: true
# OIDC
profile::idm::oidc_service: idmcloud

# IDM options
profile::idm::service_fqdn: 'cloudtestidm.wikimedia.org'
profile::idm::production: false
profile::idm::install_via_git: false
profile::idm::server::django_mysql_db_host: 'm5-master.eqiad.wmnet'
profile::idm::server::django_mysql_db_user: 'idmcloud'
profile::idm::server::django_mysql_db_name: 'idmcloud'
profile::idm::config_template: 'idm/idmcloud-django-settings.erb'

# TLS options
profile::idm::envoy_termination: true
profile::tlsproxy::envoy::upstream_addr: 127.0.0.1
profile::tlsproxy::envoy::use_remote_address: true
profile::tlsproxy::envoy::listen_ipv6: true
profile::tlsproxy::envoy::services:
  - server_names: ['cloudtestidm.wikimedia.org']
    port: 80

profile::tlsproxy::envoy::global_cert_name: "cloudtestidm.discovery.wmnet"
profile::tlsproxy::envoy::ssl_provider: 'cfssl'
profile::tlsproxy::envoy::cfssl_options:
  hosts:
    - cloudtestidm.wikimedia.org

# Redis
profile::idm::redis_master: 'cloudidm2001-dev.codfw.wmnet'
profile::idm::redis_replicas: []

profile::idm::enable_monitoring: true

# LDAP
profile::idm::ldap_dn: 'cn=bitu,ou=profile,dc=wikimedia,dc=org'
ldap:
  rw-server: 'cloudservices2004-dev.codfw.wmnet'
  users_cn: 'ou=people'
  groups_cn: 'ou=groups'
  base-dn: 'dc=wikimedia,dc=org'

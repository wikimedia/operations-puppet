[Unit]
Description=Kubernetes API Server

[Service]
User=kubernetes
Group=kubernetes
ExecStart=/usr/bin/kube-apiserver \
    --etcd-servers=<%= @etcd_servers %> \
    --service-cluster-ip-range=192.168.0.0/24 \
    --token-auth-file=/etc/kubernetes/tokenauth \
    --admission-control=NamespaceLifecycle,ServiceAccount,ResourceQuota,LimitRanger,UidEnforcer \
    --authorization-mode=ABAC \
    --authorization-policy-file=/etc/kubernetes/abac \
    --tls-private-key-file=<%= scope['::k8s::ssl::server_private_key_path'] %> \
    --tls-cert-file=<%= scope['::k8s::ssl::server_cert_path'] %> \
    --service-account-key-file=<%= scope['::k8s::ssl::server_private_key_path'] %>

[Install]
WantedBy=multi-user.target

#####################################################################
### THIS FILE IS MANAGED BY PUPPET
### puppet:///modules/contint/apache/localvhost.erb
#####################################################################

<VirtualHost *:<%= @port %>>
	ServerName localhost
	DocumentRoot <%= @docroot %>

	# Lame examples::
	# http://localhost:9413/CirrusSearch/
	# http://localhost:9413/CirrusSearch/Main_Page
	# http://localhost:9413/CirrusSearch/api.php
	RewriteEngine on
	RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
	RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-d
	RewriteRule ^/([\w-]+)/(.*)?$ /$1/index.php [L]

	<Directory />
		Order deny,allow
		Deny from all
	</Directory>

	<Directory <%= @docroot %>>
		Options +Indexes
		Options FollowSymLinks

		Order deny,allow
		Deny from all
		Allow from 127.0.0.1/32
		Allow from ::1/128
	</Directory>

	LogLevel warn
	ErrorLog /var/log/apache2/<%= @log_prefix %>_error.log
	CustomLog /var/log/apache2/<%= @log_prefix %>_access.log vhost_combined
</VirtualHost>

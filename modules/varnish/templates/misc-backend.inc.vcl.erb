include "misc-common.inc.vcl";

sub cluster_be_recv_pre_purge { }

sub cluster_be_recv {
    call misc_recv_pass;
}

sub cluster_be_hash { }
sub cluster_be_hit { }
sub cluster_be_miss { }
sub cluster_be_pass { }
sub cluster_be_backend_fetch { }
sub cluster_be_backend_response_early { }

sub cluster_be_backend_response {
    // Do not cache explicit lengths >= ~1GB in backends in general
    if (beresp.http.Content-Length ~ "^[0-9]{10}") {
	// Probably HFP
	set beresp.http.X-CDIS = "pass";
        set beresp.uncacheable = true;
        return (deliver);
    }
}

sub cluster_be_deliver { }

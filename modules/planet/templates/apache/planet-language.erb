# Apache config template for a *.planet language site

<VirtualHost *:80>
        DocumentRoot /var/www/planet/<%= @name %>
        ServerName <%= @name %>.planet.<%= scope.lookupvar('planet::planet_domain_name') %>
        php_admin_flag engine off

        <Directory /var/www/planet/<%= @name %>>
                Allow from all
        </Directory>
</VirtualHost>

<VirtualHost *:443>
        DocumentRoot /var/www/planet/<%= @name %>

        ServerName <%= @name %>.planet.<%= scope.lookupvar('planet::planet_domain_name') %>
        SSLEngine on
        SSLProtocol +ALL -SSLv2
        SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:ECDHE-RSA-RC4-SHA:ECDHE-ECDSA-RC4-SHA:AES128:AES256:RC4-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!3DES:!MD5:!PSK:!DH
        SSLHonorCipherOrder on
        SSLCertificateFile /etc/ssl/certs/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.pem
        SSLCertificateChainFile /etc/ssl/certs/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.chained.pem
        SSLCertificateKeyFile /etc/ssl/private/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.key

        <Directory /var/www/planet/<%= @name %>>
                Allow from all
        </Directory>

</VirtualHost>

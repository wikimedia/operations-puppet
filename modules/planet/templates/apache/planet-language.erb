# Apache config template for a *.planet language site

<VirtualHost *:80>
        DocumentRoot /var/www/planet/<%= @name %>
        ServerName <%= @name %>.planet.<%= scope.lookupvar('planet::planet_domain_name') %>
        php_admin_flag engine off

        <Directory /var/www/planet/<%= @name %>>
                Allow from all
        </Directory>
</VirtualHost>

<VirtualHost *:443>
        DocumentRoot /var/www/planet/<%= @name %>

        ServerName <%= @name %>.planet.<%= scope.lookupvar('planet::planet_domain_name') %>
        SSLEngine on
        SSLCertificateFile /etc/ssl/localcerts/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.crt
        SSLCertificateChainFile /etc/localssl/certs/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.chained.crt
        SSLCertificateKeyFile /etc/ssl/private/star.planet.<%= scope.lookupvar('planet::planet_domain_name') %>.key
        <%= @ssl_settings.join("\n") %>

        <Directory /var/www/planet/<%= @name %>>
                Allow from all
        </Directory>

</VirtualHost>

path ~ ^/catalog/([^/]+)$
method find
allow $1

path ~ ^/node/([^/]+)$
method find
allow $1

path /certificate_revocation_list/ca
method find
allow *

path ~ ^/report/([^/]+)$
method save
allow $1

path /certificate/ca
auth any
method find
allow *

path /certificate/
auth any
method find
allow *

path /certificate_request
auth any
method find, save
allow *

path /file
<% scope.lookupvar('puppetmaster::allow_from').each do |entry| -%>
   allow_ip <%= entry %>
<% end -%>
<% scope.lookupvar('puppetmaster::deny_from').each do |entry| -%>
   deny <%= entry %>
<% end -%>

path /
auth any

# SPDX-License-Identifier: Apache-2.0

"admin_only": "rule:context_is_admin"
"admin_or_member": "context_is_admin:True or role:member"
"shared_firewalls": "field:firewalls:shared=True"
"shared_firewall_policies": "field:firewall_policies:shared=True"
"default": "rule:admin_only"

# In this file, 'regular user' means 'anyone with api access'
#  and is applied to read-only methods
"regular_user": ""


"get_subnet": "rule:regular_user"
"create_subnetpool": "rule:admin_only"
"get_subnetpool": "rule:regular_user"
"update_subnetpool": "rule:admin_only"
"delete_subnetpool": "rule:admin_only"
"create_address_scope": "rule:admin_or_member"
"get_address_scope": "rule:regular_user"
"update_address_scope": "rule:admin_only"
"delete_address_scope": "rule:admin_only"
"create_network": "rule:admin_only"
"get_network": "rule:regular_user"
"get_network:queue_id": "rule:admin_only"
"get_network_ip_availabilities": "rule:admin_only"
"update_network": "rule:admin_only"
"delete_network": "rule:admin_only"
"create_port": "rule:admin_or_member"
"create_port:device_id": "rule:admin_or_member"
"get_port": "rule:regular_user"
"get_port:queue_id": "rule:admin_only"
"create_router": "rule:admin_only"
"get_router": "rule:admin_only"
"delete_router": "rule:admin_only"
"add_router_interface": "rule:admin_only"
"remove_router_interface": "rule:admin_only"
"create_firewall": "rule:admin_or_member"
"get_firewall": "rule:admin_only"
"create_firewall:shared": "rule:admin_only"
"get_firewall:shared": "rule:admin_only"
"update_firewall": "rule:admin_only"
"update_firewall:shared": "rule:admin_only"
"delete_firewall": "rule:admin_only"
"create_firewall_policy": "rule:admin_or_member"
"get_firewall_policy": "rule:regular_user"
"create_firewall_policy:shared": "rule:admin_only"
"update_firewall_policy": "rule:admin_only"
"delete_firewall_policy": "rule:admin_only"
"insert_rule": "rule:admin_only"
"remove_rule": "rule:admin_only"
"create_firewall_rule": "rule:admin_or_member"
"get_firewall_rule": "rule:regular_user"
"update_firewall_rule": "rule:admin_only"
"delete_firewall_rule": "rule:admin_only"
"create_qos_queue": "rule:admin_only"
"get_qos_queue": "rule:regular_user"
"get_loadbalancer-agent": "rule:admin_only"
"get_loadbalancer-pools": "rule:admin_only"
"get_agent-loadbalancers": "rule:admin_only"
"get_loadbalancer-hosting-agent": "rule:admin_only"
"create_floatingip": "rule:admin_or_member"
"update_floatingip": "rule:admin_or_member"
"delete_floatingip": "rule:admin_or_member"
"get_floatingip": "rule:regular_user"
"create_network_profile": "rule:admin_only"
"update_network_profile": "rule:admin_only"
"delete_network_profile": "rule:admin_only"
"get_network_profiles": "rule:regular_user"
"get_network_profile": "rule:regular_user"
"update_policy_profiles": "rule:admin_only"
"get_policy_profiles": "rule:regular_user"
"get_policy_profile": "rule:regular_user"
"get_lsn": "rule:admin_only"
"create_lsn": "rule:admin_only"
"get_flavors": "rule:regular_user"
"get_service_profiles": "rule:admin_only"
"create_rbac_policy": "rule:admin_or_member"
"update_rbac_policy": "rule:admin_only"
"get_rbac_policy": "rule:admin_only"
"delete_rbac_policy": "rule:admin_only"
"get_auto_allocated_topology": "rule:admin_only"
"get_bgp_speaker": "rule:admin_only"
"create_bgp_speaker": "rule:admin_only"
"update_bgp_speaker": "rule:admin_only"
"delete_bgp_speaker": "rule:admin_only"
"get_bgp_peer": "rule:admin_only"
"create_bgp_peer": "rule:admin_only"
"update_bgp_peer": "rule:admin_only"
"delete_bgp_peer": "rule:admin_only"
"add_bgp_peer": "rule:admin_only"
"remove_bgp_peer": "rule:admin_only"
"add_gateway_network": "rule:admin_only"
"remove_gateway_network": "rule:admin_only"
"get_advertised_routes": "rule:admin_only"
"add_bgp_speaker_to_dragent": "rule:admin_only"
"remove_bgp_speaker_from_dragent": "rule:admin_only"
"list_bgp_speaker_on_dragent": "rule:admin_only"
"list_dragent_hosting_bgp_speaker": "rule:admin_only"
"create_security_group": "rule:admin_or_member"
"get_security_groups": "rule:regular_user"
"get_security_group": "rule:regular_user"
"update_security_group": "rule:admin_or_member"
"delete_security_group": "rule:admin_or_member"
"create_security_group_rule": "rule:admin_or_member"
"get_security_group_rules": "rule:regular_user"
"get_security_group_rule": "rule:regular_user"
"delete_security_group_rule": "rule:admin_or_member"


# The following allow heat/magnum to do necessary setup. There's a bit of explanation
#  at https://bugs.launchpad.net/neutron/+bug/1833455 although experimentation
#  shows the extra three rules are needed.
#
# See also upstream patch https://review.opendev.org/c/openstack/neutron/+/886214
"create_port:fixed_ips:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"update_port:fixed_ips:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"create_port:fixed_ips:subnet_id": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"update_port:fixed_ips:subnet_id": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"create_port:allowed_address_pairs": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"update_port:allowed_address_pairs": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"create_port:allowed_address_pairs:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"
"update_port:allowed_address_pairs:ip_address": "rule:context_is_advsvc or rule:admin_or_network_owner or rule:shared"

[Unit]
Description=Wikidate Query Service Updater

[Service]
Type=simple
WorkingDirectory=<%= scope.lookupvar("wdqs::service::package_dir") %>
ExecStart=/bin/bash <%= scope.lookupvar("wdqs::service::package_dir") %>/runBlazegraph.sh -f <%= scope.lookupvar("wdqs::service::config_file") %>
User=<%= scope.lookupvar("wdqs::service::username") %>
StandardOutput=journal+console
Restart=always

PrivateTmp=yes
PrivateDevices=yes
ProtectSystem=full
ProtectHome=yes
NoNewPrivileges=yes
RestrictAddressFamilies=AF_UNIX AF_INET AF_INET6

ReadOnlyDirectories=/
# data storage
ReadWriteDirectories=/srv/wdqs
# logs
ReadWriteDirectories=/var/log/wdqs
# already protected by PrivateTmp
ReadWriteDirectories=/tmp /var/tmp

[Install]

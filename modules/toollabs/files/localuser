#! /bin/bash
#
# THIS FILE IS MAINTAINED BY PUPPET
# source: modules/toollabs/files/localuser
# from:   toollabs::mailrelay
#

# Mail for root is handled by the maintainers of the admin service
# group.
if [ "x$1" = "xroot" ]; then
    exec maintainers tools.admin
fi

echo $(
  /usr/bin/ldapsearch -LLL -x -b "uid=$1,ou=people,dc=wikimedia,dc=org" mail |
  	/bin/sed -ne '/^mail: \(.*\)/{;s//\1,/;p;}'
) | sed -e 's/,\s*$//'


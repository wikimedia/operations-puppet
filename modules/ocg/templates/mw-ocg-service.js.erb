/* ---------------------------------------------------------------------
 * THIS FILE IS MANAGED BY PUPPET
 * /modules/ocg/templates/mw-collection-ocg.js.erb
 *
 * It is intended to be included by the main configuration file
 * in the deploy repository. This just allows puppetization of
 * sensitive parameters that are better defined via puppet.
 * ------------------------------------------------------------------ */

module.exports = function (config) {
	config.coordinator.hostname = "<%= @host_name %>";

	config.redis.host = "<%= @redis_host %>";
	config.redis.port = <%= @redis_port %>;
	config.redis.password = "<%= @redis_password %>";

	config.frontend.port = <%= @service_port %>;

	config.reporting.statsd_server = "<%= @statsd_host %>";
	config.reporting.statsd_port = <%= @statsd_port %>;
	config.reporting.is_txstatsd = <%= @statsd_is_txstatsd %>;

	// File paths; there is a short term temp directory, a long term
	// storage directory, and a medium term error directory
	config.backend.temp_dir = "<%= @temp_dir %>";
	config.backend.output_dir = "<%= @output_dir %>";
	config.backend.post_mortem_dir = "<%= @postmortem_dir %>";

	// Log to both syslog and logstash as an interim thing
	logger.add( require( 'winston-posix-syslog' ).PosixSyslog, { level: 'debug' } );
	logger.add( require( 'winston-graylog2' ).Graylog2, {
		level: 'debug',
		graylogHost: "<%= @graylog_host %>",
		graylogPort: "<%= @graylog_port %>",
		graylogFacility: "OfflineContentGenerator",
	} );

	// Import the public local settings
	return require("/srv/deployment/ocg/ocg/LocalSettings.js")(config)
}

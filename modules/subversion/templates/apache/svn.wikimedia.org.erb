# This file is managed by puppet
# vim: filetype=apache

<VirtualHost *:80>
    ServerName svn.wikimedia.org
    DocumentRoot /srv/org/wikimedia/svn

    Redirect permanent /doc https://doc.wikimedia.org/mediawiki-core/master/php/html
    Redirect permanent /viewvc/mediawiki https://phabricator.wikimedia.org/diffusion/SVN/
    Redirect permanent /viewvc/mysql https://phabricator.wikimedia.org/diffusion/SVNM/
    Redirect permanent /viewvc/pywikipedia https://phabricator.wikimedia.org/diffusion/SVNP/
    Redirect permanent / https://phabricator.wikimedia.org/diffusion/
</VirtualHost>

NameVirtualHost *:443
<VirtualHost *:443>
    ServerName svn.wikimedia.org
    DocumentRoot /srv/org/wikimedia/svn

    SSLEngine on
    SSLCertificateFile /etc/ssl/localcerts/svn.wikimedia.org.crt
    SSLCertificateKeyFile /etc/ssl/private/svn.wikimedia.org.key
    SSLCACertificatePath /etc/ssl/certs/
    <%= @ssl_settings.join("\n") %>

    Redirect permanent /doc https://doc.wikimedia.org/mediawiki-core/master/php/html
    Redirect permanent /viewvc/mediawiki https://phabricator.wikimedia.org/diffusion/SVN/
    Redirect permanent /viewvc/mysql https://phabricator.wikimedia.org/diffusion/SVNM/
    Redirect permanent /viewvc/pywikipedia https://phabricator.wikimedia.org/diffusion/SVNP/
    Redirect permanent / https://phabricator.wikimedia.org/diffusion/
</VirtualHost>

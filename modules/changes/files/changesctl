#!/bin/bash
# changesctl -- Manage Changes jobs
# Usage: changesctl {status|start|stop|restart}
#
command=$1
shift
case "$command" in
    status)
        initctl list | grep -Po '(?<=changes/)(?!init).*' | sort -k5 \
                | sed 's/, process//' | column -ts'( )'
        ;;
    start)
        initctl emit changes.start
        ;;
    stop)
        initctl emit changes.stop
        ;;
    restart)
        initctl emit changes.stop
        initctl emit changes.start
        ;;
    *)
        echo >&2 "Usage: ${0##*/} {status|start|stop|restart}"
        ;;
esac

# This file is managed by puppet

[rsync]
accept = :::1873
client = no

<%- if @ssl_paths -%>
CAfile = <%= @ssl_paths['chained'] %>
cert   = <%= @ssl_paths['cert'] %>
key    = <%= @ssl_paths['key'] %>
<%- else -%>
CAfile = <%= scope.call_function('puppet_ssldir', []) + "/certs/ca.pem" %>
cert   = <%= scope.call_function('puppet_ssldir', []) + "/certs/#{@fqdn}.pem" %>
key    = <%= scope.call_function('puppet_ssldir', []) + "/private_keys/#{@fqdn}.pem" %>
<%- end -%>

verifyChain = yes

exec = /usr/bin/rsync
execargs = rsync --daemon --config /etc/rsyncd.conf

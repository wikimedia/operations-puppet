###########################
# sentry-ldap-auth plugin #
###########################

import ldap
from django_auth_ldap.config import LDAPSearch, GroupOfUniqueNamesType

AUTHENTICATION_BACKENDS = AUTHENTICATION_BACKENDS + (
    'sentry_ldap_auth.backend.SentryLdapBackend',
)
SENTRY_MANAGED_USER_FIELDS = ('email', 'first_name', 'last_name', 'password', )

#AUTH_LDAP_SERVER_URI = 'ldaps://ldap-eqiad.wikimedia.org ldap-codfw.wikimedia.org/ou=people,dc=wikimedia,dc=org?cn
#AUTH_LDAP_BIND_DN = ''
#AUTH_LDAP_BIND_PASSWORD = ''

AUTH_LDAP_USER_DN_TEMPLATE = 'uid=%(user)s,ou=people,dc=wikimedia,dc=org'
AUTH_LDAP_USER_SEARCH = LDAPSearch(
    'ou=people,dc=wikimedia,dc=org',
    ldap.SCOPE_SUBTREE,
    '(uid=%(user)s)',
)
AUTH_LDAP_GROUP_SEARCH = LDAPSearch(
    'ou=groups,dc=wikimedia,dc=org',
    ldap.SCOPE_SUBTREE,
    '(objectClass=groupOfNames)'
)
AUTH_LDAP_USER_ATTR_MAP = {
    'first_name':
    'last_name':
    'email':
}
AUTH_LDAP_USER_FLAGS_BY_GROUP = {
    'is_wmf': 'cn=wmf,ou=groups,dc=wikimedia,dc=org',
    'is_nda': 'cn=nda,ou=groups,dc=wikimedia,dc=org',
    'is_ops': 'cn=ops,ou=groups,dc=wikimedia,dc=org',
}

AUTH_LDAP_DEFAULT_SENTRY_ORGANIZATION = 'Wikimedia'


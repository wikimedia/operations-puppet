#####################################################################
### THIS FILE IS MANAGED BY PUPPET
### puppet:///modules/dumps/rsync/rsyncd.conf.dumps_to_public
#####################################################################

# rsync config for public retrievers/mirrors of XML dumps

[dumpmirrorslastfivedumps]
# not really, we should transition people to using the module below
read only = true
path = <%= @xmldumpsdir %>
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/ *.inprog
hosts allow = <%= @hosts_allow %>

# these are the modules to advertise

[dumpslastfive]
read only = true
# this includes only the last five good dumps.
path = <%= @xmldumpsdir %>
include = /*wik*/
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog /* /*/ /*/*/
include from = <%= @xmldumpsdir %>/rsync-inc-last-5.txt
hosts allow = <%= @hosts_allow %>

[dumpslastfour]
read only = true
# this includes only the last four good dumps.
path = <%= @xmldumpsdir %>
include = /*wik*/
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog /* /*/ /*/*/
include from = <%= @xmldumpsdir %>/rsync-inc-last-4.txt
hosts allow = <%= @hosts_allow %>

[dumpslastthree]
read only = true
# this includes only the last three good dumps.
path = <%= @xmldumpsdir %>
include = /*wik*/
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog /* /*/ /*/*/
include from = <%= @xmldumpsdir %>/rsync-inc-last-3.txt
hosts allow = <%= @hosts_allow %>

[dumpslasttwo]
read only = true
# this includes only the last two good dumps.
path = <%= @xmldumpsdir %>
include = /*wik*/
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog /* /*/ /*/*/
include from = <%= @xmldumpsdir %>/rsync-inc-last-2.txt
hosts allow = <%= @hosts_allow %>

[dumpslastone]
read only = true
# this includes only the last good dump.
path = <%= @xmldumpsdir %>
include = /*wik*/
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog /* /*/ /*/*/
include from = <%= @xmldumpsdir %>/rsync-inc-last-1.txt
hosts allow = <%= @hosts_allow %>

[dumpmirrorsother]
read only = true
path = <%= @miscdatasetsdir %>
exclude = **tmp/ **temp/ **bad/ **save/ **archive/
hosts allow = <%= @hosts_allow %>

[dumpmirrorsalldumps]
read only = true
# this includes only dumps, no archives, no other datasets
path = <%= @xmldumpsdir %>
exclude = **tmp/ **temp/ **bad/ **save/ **other/ **archive/ **not/  *.inprog
hosts allow = <%= @hosts_allow %>

[dumpmirrorseverything]
read only = true
# this includes archives, other datasets
path = <%= @xmldumpsdir %>
exclude = **tmp/ **temp/ **bad/ **save/ **not/ *.inprog
# ip addresses are: 69.31.98.2 your.org, 199.47.196.26 wansecurity.com, 69.28.137.74 iconicindustry.com
hosts allow = <%= @hosts_allow %> 199.47.196.26 69.31.98.2 69.28.137.74

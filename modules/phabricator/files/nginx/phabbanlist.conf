# Using mod_remoteip we have access to the client IP
# for as long as X-Client-IP is accurate

# Docs:
# https://httpd.apache.org/docs/2.4/howto/access.html
# https://httpd.apache.org/docs/2.4/expr.html

# Examples:
# deny 23.255.244.254

# - top user agents -
# time ngrep -n 200 port 80 -W byline | grep -i user-agent | sort | uniq -c | sort -n
# - (ignorant of the headers but...) you can get an idea of accessed uri's live -
# httpry -f timestamp,source-ip,request-uri | egrep -i diffusion
# - top in use URL from log -
# apachetop -lf /var/log/apache2/phabricator_access.log

# Aggressive bot not honoring the robots /diffusion exclude 2015/12/16
deny 45.32.160.62

# aggressive bot, claims to be https://www.teorem.se/bot.html but url is 404
deny 90.227.4.251

# jice.ddns.net cloning the site for
# nefarious purposes
deny ip 68.32.11.161

# phabricator.wikimedia.net.ru no thanks
deny 155.254.49.17

# spam bot source (3 today)
deny 103.199.120.16

# spam bots (already blocked on enwiki for 1 yr)
# '{{blocked proxy}}: consistent source of spam account creation'
deny 103.38.177.2

## file sharing attempts in early 2017
# Movicel, Luanda, Angola, (GPSRS/HSDPA)
deny 41.70.235.208
# Movicel, Luanda, Angola
deny 41.70.243.74
# TV Cabo, Luanda, Angola
deny 41.222.251.22
# Angola Telecom, Benguela, Angola
deny 197.216.8.0/24

## file sharing in June/July 2017
# https://phabricator.wikimedia.org/T168142
# Temporarily superseded by https://gerrit.wikimedia.org/r/#/c/363264/
# https://wikitech.wikimedia.org/wiki/Incident_documentation/20170617-Phabricator-spam
# Maroc Telekom, Office National des Postes et Telecommunications O,
# MTN SA MOBILE, Meditelecom, Meditel Mobile, Optimum-Telecom-Algeria
deny 41.92.0.0/17
deny 41.140.0.0/14
deny 41.248.0.0/14
deny 45.216.0.0/14
deny 105.128.0.0/11
deny 105.188.0.0/14
deny 129.45.0.0/17
deny 160.160.0.0/12
deny 196.64.0.0/11
deny 197.128.0.0/14

# vandalism in 07-08/2017
deny 220.134.46.118

[Unit]
Description=Aphlict - Phabricator notification service
After=syslog.target network.target auditd.service mysql.service
Before=apache2.service

[Service]
Type=forking
User=<%= scope.lookupvar('phabricator::aphlict::user') %>
Group=<%= scope.lookupvar('phabricator::aphlict::group') %>
Environment="PHABRICATOR_ENV=aphlict"
ExecStartPre=-/bin/mkdir -p /var/run/phd/
ExecStartPre=/bin/chown -R phd:phd /var/run/phd/
ExecStart=<%= scope.lookupvar('phabricator::aphlict::aphlict_start_cmd') %>
ExecReload=<%= scope.lookupvar('phabricator::aphlict::aphlict_restart_cmd') %>
ExecStop=<%= scope.lookupvar('phabricator::aphlict::aphlict_stop_cmd') %>

[Install]
WantedBy=multi-user.target
Alias=aphlict.service

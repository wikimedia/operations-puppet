###
####    This file managed by puppet.
###

### udp2log packet loss monitoring
pipe 10 /usr/bin/packet-loss 10 '\t' >> <%= packet_loss_log %>

### Fundraising
## Landing pages
pipe 1 /usr/bin/udp-filter -F '\t' -d wikimediafoundation.org,donate.wikimedia.org >> <%= fundraising_log_directory %>/logs/landingpages.tsv.log

## Banner Impressions
pipe 100 /usr/bin/udp-filter -F '\t' -p Special:RecordImpression\?banner=,Special:RecordImpression\?result= | /usr/bin/tee <%= fundraising_log_directory %>/logs/bannerImpressions-sampled100.tsv.log | /usr/bin/log2udp -h <%= fundraising_udp_host %> -p <%= fundraising_udp_port %>


### webstatscollector -- domas
# NOTE!  The files that filter and collector (on gadolinium) generates
# are rsynced over to dataset2 by a cron maintained by
# apergos running on snapshot1.
# gadolinium.wikimedia.org:3815 should be the webstats collector process.
pipe 1 /usr/local/bin/filter | /usr/bin/log2udp -h gadolinium.wikimedia.org -p 3815
